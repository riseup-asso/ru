name: riseup

services:

  drupal:
    build:
      context: .
      dockerfile: ./Dockerfile
    ports:
     - "8000:80"
    volumes:
     - files:"/opt/drupal/web/sites/default/files"
     - "./sites:/opt/drupal/web/sites"
     - "./web/themes/contrib/tara:/var/www/html/themes/contrib/tara"
     - "./web/themes/contrib/ta_rayse_up:/var/www/html/themes/contrib/ta_rayse_up"
    restart: unless-stopped
    environment:
      - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
      - TRUSTED_HOST=${TRUSTED_HOST}
      - OEMBED_TRUSTED_HOST=${OEMBED_TRUSTED_HOST}

  db:
    image: postgres:16
    environment:
      - POSTGRES_USER="drupal"
      - POSTGRES_DB="drupal"
      - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
    volumes:
      - postgresql:"/var/lib/postgresql/data"
    restart: unless-stopped

  volumes:
    files:

    postgresql:

